# 레퍼런스 카운터와 가비지 컬렉션

## 가비지 컬렉션

원래 다음과 같은 상황에서 변수 s에 문자열이 저장되었다고 표현한다.

```python3
s = 'Garbage Collection'
```

근데 사실 문자열 객체 'Garbage Collection'에 s라는 이름이 붙은 것 !

즉 파이썬의 변수는 빈 상자가 아닌 떼었다 붙였다 할 수 있는 **포스트잇** 개념

* 변수 s에 문자열 'Garbage Collection'이 저장되었다. (X)

* 변수 s가 문자열 'Garbage Collection'을 **레퍼런스** 한다. (O)

변수 r이 리스트 객체를 레퍼런스하고 있다.

```python3
r = [1, 2, 3]
```
그럼 리스트 [1, 2, 3]은 언제 소멸?

=> 객체를 아무도 참조하지 않는 상황
```python3
r = [1, 2, 3]
r = 'simple'
```
이렇게 r이 다른걸 참조해버리면 리스트 [1, 2, 3]은 아무도 안쓰게 되어서 소멸 대상이 된다.

소멸 대상이 되었다고 바로 소멸되는 것은 아니고 시스템에 시간적 여유가 생기면 소멸시킨다.

이러한 소멸 규칙 및 과정을 **가비지 컬렉션(Garbage Collection)** 이라 한다.

더 자세히 보자

```python3
r1 = [1, 2, 3] # 리스트 [1, 2, 3]의 레퍼런스 카운트는 1
r2 = r1        # 리스트의 레퍼런스 카운트 2
r1 = 'simple'  # 리스트의 레퍼런스 카운트는 다시 1
r2 = 'happy'   # 리스트의 레퍼런스 카운트 0, 따라서 가비지 컬렉션 대상
```
가비지 컬렉션은 누가 하는 것인가?

=> 파이썬 인터프리터

## 파이썬 인터프리터

파이썬 코드를 작성하고 실행하면 이 코드가 **바이트 코드** 라는 것으로 바뀌어서 어딘가에 저장이 되고 이 바이트 코드는 **파이썬 가상 머신(PVM)** 위에서 실행이 된다.

실제 파이썬 프로그램의 실행 주체는 파이썬 가상 머신이라고 할 수 있으며 PVM에 의해 가비지 컬렉션도 진행이 된다.

파이썬 코드 변환기와 가상 머신, 기본적으로 포함되는 각종 라이브러리들을 묶어서 **파이썬 인터프리터** 라고 한다.

파이썬 인터프리터는 PVM이 어떤 언어로 구현되었는지에 따라 다양한 종류가 존재한다. (CPython, Jython ...)
